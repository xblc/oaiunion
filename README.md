# Go OAI Gateway - Golang OpenAI ç›¸å®¹ API èšåˆå™¨

é€™æ˜¯ä¸€å€‹ä½¿ç”¨ Golang é–‹ç™¼çš„æœ¬åœ°ã€é«˜æ•ˆã€å¯é…ç½®çš„ OpenAI API ç›¸å®¹èšåˆèˆ‡è½‰ç™¼æœå‹™ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

*   **å¤šå¾Œç«¯èšåˆ**: åœ¨å–®ä¸€çš„æœ¬åœ°ç«¯é» (`127.0.0.1:8080`) èšåˆå¤šå€‹ä¸åŒçš„ OpenAI ç›¸å®¹ API æœå‹™ã€‚
*   **çµ±ä¸€ API å…¥å£**: ç„¡éœ€åœ¨å®¢æˆ¶ç«¯æ‡‰ç”¨ä¸­ç®¡ç†å¤šå€‹ API Key å’Œ URLï¼Œæ‰€æœ‰è«‹æ±‚éƒ½ç™¼é€åˆ°æœ¬æœå‹™ã€‚
*   **æ™ºæ…§è·¯ç”±**: æ ¹æ“šè«‹æ±‚çš„æ¨¡å‹åç¨±ï¼Œè‡ªå‹•å°‡è«‹æ±‚è½‰ç™¼åˆ°æ”¯æ´è©²æ¨¡å‹çš„å¾Œç«¯æœå‹™ã€‚
*   **è² è¼‰å¹³è¡¡**: ç•¶å¤šå€‹å¾Œç«¯æ”¯æ´åŒä¸€å€‹æ¨¡å‹æ™‚ï¼Œè‡ªå‹•é€²è¡ŒåŠ æ¬Šè¼ªè©¢è² è¼‰å¹³è¡¡ã€‚
*   **æ¨¡å‹åˆ¥åèˆ‡åˆä½µ**: å¯é€šéè¨­å®šæª”å°‡ä¸åŒå¾Œç«¯çš„ç›¸ä¼¼æ¨¡å‹ï¼ˆå¦‚ `gpt-4-turbo-preview` å’Œ `gpt-4-1106-preview`ï¼‰åˆä½µç‚ºä¸€å€‹çµ±ä¸€çš„åç¨±ï¼ˆå¦‚ `gpt-4-turbo`ï¼‰ï¼Œä¸¦å°å…¶é€²è¡Œè¼ªè©¢ã€‚
*   **æµå¼å‚³è¼¸æ”¯æ´**: å®Œå…¨æ”¯æ´ `stream: true`ï¼Œèƒ½å¤ åƒåŸç”Ÿ API ä¸€æ¨£å¯¦ç¾æ‰“å­—æ©Ÿæ•ˆæœã€‚
*   **é«˜æ•ˆç‡èˆ‡ä½å»¶é²**: åŸºæ–¼ Golang çš„é«˜æ•ˆèƒ½ç‰¹æ€§ï¼Œç‚ºæ‚¨çš„ AI æ‡‰ç”¨æä¾›ä½å»¶é²çš„æœ¬åœ°è½‰ç™¼ã€‚

## ğŸš€ å¦‚ä½•é–‹å§‹

### 1. å‰ææ¢ä»¶

*   å®‰è£ [Go](https://go.dev/doc/install) (å»ºè­°ç‰ˆæœ¬ 1.21 æˆ–æ›´é«˜)ã€‚

### 2. å®‰è£

```bash
# ä¸‹è¼‰å°ˆæ¡ˆ
git clone https://github.com/your-username/go-oai-gateway.git
cd go-oai-gateway

# å®‰è£ä¾è³´é …
go mod tidy
```

### 3. è¨­å®š

è¤‡è£½æˆ–é‡å‘½å `config.yaml.example` ç‚º `config.yaml`ï¼Œä¸¦æ ¹æ“šæ‚¨çš„éœ€æ±‚é€²è¡Œä¿®æ”¹ã€‚

```yaml
# config.yaml

# æœå‹™ç›£è½çš„æœ¬åœ°åœ°å€å’Œç«¯å£
server:
  host: "127.0.0.1"
  port: 8080

# å¾Œç«¯ API ç«¯é»åˆ—è¡¨
# åœ¨é€™è£¡å¡«å…¥æ‚¨è‡ªå·±çš„ OpenAI ç›¸å®¹æœå‹™æä¾›å•†
endpoints:
  - name: "your-provider-1" # ç«¯é»çš„å”¯ä¸€æ¨™è­˜ç¬¦
    base_url: "https://api.your-provider-1.com/v1" # æœå‹™çš„åŸºç¤ URL
    api_key: "sk-your-provider-1-key" # æ‚¨çš„ API Key
    weight: 10 # åŠ æ¬Šè¼ªè©¢çš„æ¬Šé‡

  - name: "your-provider-2"
    base_url: "https://api.your-provider-2.com/v1"
    api_key: "sk-your-provider-2-key"
    weight: 5

# æ¨¡å‹è·¯ç”±èˆ‡åˆä½µç­–ç•¥
routing:
  # 'merge': (æ¨è–¦) åˆä½µæ‰€æœ‰ç«¯é»çš„åŒåæ¨¡å‹ï¼Œé€²è¡Œè¼ªè©¢ã€‚
  # 'prefix': ç‚ºæ¯å€‹æ¨¡å‹åŠ ä¸Šç«¯é»åç¨±å‰ç¶´ï¼Œä¾‹å¦‚ 'your-provider-1/gpt-4'ã€‚
  mode: "merge"

  # æ‰‹å‹•é‡å¯«å’Œåˆä½µè¦å‰‡ (åƒ…åœ¨ mode: 'merge' ä¸‹ç”Ÿæ•ˆ)
  model_overrides:
    "claude-3-opus":
      - "your-provider-1/claude-3-opus-20240229"
      - "your-provider-2/claude-v3-opus"
    "gpt-4-turbo":
      - "your-provider-1/gpt-4-turbo-preview"
```

### 4. å•Ÿå‹•æœå‹™

```bash
go run main.go
```

æœå‹™å•Ÿå‹•å¾Œï¼Œå°‡ç›£è½åœ¨ `http://127.0.0.1:8080`ã€‚

### 5. ä½¿ç”¨

ç¾åœ¨ï¼Œæ‚¨å¯ä»¥å°‡æ‚¨çš„ AI æ‡‰ç”¨ç¨‹å¼çš„ API ç«¯é»æŒ‡å‘ `http://127.0.0.1:8080/v1`ï¼Œä¸¦åƒä½¿ç”¨å–®ä¸€ OpenAI æœå‹™ä¸€æ¨£ä½¿ç”¨å®ƒã€‚

ä¾‹å¦‚ï¼Œä½¿ç”¨ `curl` æ¸¬è©¦ï¼š

```bash
# ç²å–å¯ç”¨çš„æ¨¡å‹åˆ—è¡¨
curl http://127.0.0.1:8080/v1/models

# ç™¼é€ä¸€å€‹èŠå¤©è«‹æ±‚
curl http://127.0.0.1:8080/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{
    "model": "gpt-4-turbo",
    "messages": [{"role": "user", "content": "ä½ å¥½ï¼"}],
    "stream": false
  }'